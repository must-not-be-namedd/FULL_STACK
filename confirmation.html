<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Successful!</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Updated QR Code library URL to a working CDN (unpkg is often more reliable) -->
    <script src="https://unpkg.com/qrcodejs@1.0.0/qrcode.min.js"></script>
    <style>
        /* Base Styles - Copied from device-selection-ui */
        :root {
            --dark-bg: #1A1A2E; /* Very dark blue/purple */
            --form-bg-start: #2A2A4A; /* Slightly lighter for gradient start */
            --form-bg-end: #1A1A2E; /* Darker for gradient end */
            --button-gradient-start: #6A0DAD; /* Vibrant purple */
            --button-gradient-end: #4A0080; /* Deeper purple */
            --text-light: #E0E0E0;
            --text-white: #FFFFFF;
            --border-color: #444466; /* Subtle blue-grey border */
            --input-bg: #1D1D3A; /* Darker input background */
            --shadow-color-light: rgba(0, 0, 0, 0.4);
            --shadow-color-dark: rgba(0, 0, 0, 0.8);
            --link-color: #76a9ff; /* Original link color, still fits */
            --link-hover-color: #a3c4ff;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--dark-bg);
            color: var(--text-light);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            min-height: 100vh;
            background-image: radial-gradient(circle at top left, #2F2F50 0%, transparent 50%),
                              radial-gradient(circle at bottom right, #1A1A2E 0%, transparent 50%);
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            padding-top: 40px;
            padding-bottom: 40px;
            overflow-x: hidden;
        }

        /* Headings and Paragraphs */
        h1, h3, p {
            text-align: center;
            color: var(--text-white);
            margin-bottom: 15px;
            font-weight: 700;
            font-size: 1.8rem;
            letter-spacing: 0.5px;
        }

        h1 {
            overflow: hidden;
            white-space: nowrap;
            margin: 0 auto;
            border-right: .15em solid orange;
            animation: 
                typing 3.5s steps(20, end) forwards, /* Adjusted steps for "Payment Successful!" */
                blink-caret .75s step-end infinite;
            width: 0;
            max-width: 100%;
            padding-right: 5px;
            margin-bottom: 25px; /* Added margin below h1 */
        }

        h3 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-top: 25px;
            margin-bottom: 15px;
            color: var(--button-gradient-start); /* Purple color for subheadings */
            opacity: 0;
            animation: fadeIn 1s ease-in-out 4s forwards; /* Staggered animation */
        }

        p {
            font-size: 1.1rem;
            color: var(--text-light);
            line-height: 1.6;
            opacity: 0;
            animation: fadeIn 1s ease-in-out 3.5s forwards; /* Staggered animation */
        }

        /* Container for content */
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 90%;
            max-width: 600px;
            margin-top: 30px;
            padding: 30px;
            background: linear-gradient(145deg, var(--form-bg-start) 0%, var(--form-bg-end) 100%);
            border-radius: 18px;
            box-shadow: 0 10px 25px var(--shadow-color-dark);
            border: 1px solid var(--border-color);
            opacity: 0; /* Initially hide the container */
            animation: fadeIn 1s ease-in-out 3.8s forwards; /* Fade in after initial paragraph */
        }

        .container p span {
            font-weight: 600;
            color: var(--text-white);
        }

        /* Ticket Section */
        #ticket {
            margin-top: 30px;
            padding: 25px;
            background-color: rgba(30, 30, 48, 0.7);
            border-radius: 15px;
            box-shadow: 0 5px 15px var(--shadow-color-dark);
            width: 90%;
            max-width: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
            border: 1px solid var(--border-color);
            opacity: 0;
            animation: fadeIn 1s ease-in-out 4.5s forwards; /* Staggered animation */
        }

        #ticket h3 {
            margin-top: 0;
            margin-bottom: 20px;
            color: var(--button-gradient-start);
            font-size: 1.4rem;
        }

        /* QR Code Styling */
        #qr-code {
            padding: 10px;
            background-color: var(--text-white); /* White background for QR code */
            border-radius: 8px;
            display: inline-block; /* To center the QR code image */
            box-shadow: 0 2px 8px var(--shadow-color-light);
            margin: 0 auto; /* Center the QR code */
        }

        /* Footer */
        footer {
            margin-top: 40px;
            color: #888;
            font-size: 15px;
            text-align: center;
            padding: 15px;
            letter-spacing: 0.3px;
            opacity: 0;
            animation: fadeIn 1s ease-in-out 5s forwards; /* Staggered animation */
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes typing {
            from { width: 0 }
            to { width: 300px } /* Adjusted width for "Payment Successful!" */
        }

        @keyframes blink-caret {
            from, to { border-color: transparent }
            50% { border-color: orange }
        }

        /* ===================== */
        /* ðŸ“± Responsive Styling */
        /* ===================== */

        @media (max-width: 768px) {
            h1 {
                font-size: 1.6rem;
                animation: 
                    typing 3.5s steps(18, end) forwards,
                    blink-caret .75s step-end infinite;
            }
            h3 {
                font-size: 1.3rem;
            }
            p {
                font-size: 1rem;
            }
            .container {
                padding: 25px;
                border-radius: 15px;
            }
            #ticket {
                padding: 20px;
                border-radius: 12px;
            }
            footer {
                font-size: 14px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding-top: 20px;
                padding-bottom: 20px;
            }
            h1 {
                font-size: 1.4rem;
                margin-bottom: 10px;
                animation: 
                    typing 3.5s steps(16, end) forwards,
                    blink-caret .75s step-end infinite;
            }
            h3 {
                font-size: 1.2rem;
            }
            p {
                font-size: 0.95rem;
            }
            .container {
                width: 95%;
                padding: 20px;
                border-radius: 12px;
                margin-top: 20px;
            }
            #ticket {
                padding: 15px;
                border-radius: 10px;
            }
            footer {
                font-size: 13px;
                margin-top: 20px;
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Payment Successful!</h1>
        
        <p>Thank you for your booking. Here are your details:</p>

        <h3>Booking Details</h3>
        <p>Locker Location: <span id="locker-location">N/A</span></p>
        <p>Devices Rented: <span id="device-list">N/A</span></p>
        <p>Total Payment: â‚¹<span id="total-payment">0</span></p>

        <div id="ticket">
            <h3>Your Ticket</h3>
            <div id="qr-code"></div>
            <p style="font-size: 0.9rem; margin-top: 15px; color: #aaa; font-style: italic; text-align: center;">Scan this QR code at the locker to access your devices.</p>
        </div>

    </div>

    <footer>&copy; 2024 Locker Booking Service | Powered by GPS & Metro Stations</footer>

    <script>
        window.onload = function() {
            // Define a list of random Bangalore locations
            const bangaloreLocations = [
                "Majestic Metro Station",
                "Indiranagar Metro Station",
                "MG Road Metro Station",
                "Jayanagar 4th Block Bus Stop",
                "Koramangala 80 Feet Road",
                "Electronic City Phase 1",
                "Whitefield Forum Mall",
                "Banashankari Bus Stand",
                "Shivajinagar Bus Station",
                "Cubbon Park Metro Station"
            ];

            // Get a random location from the list
            const randomLockerLocation = bangaloreLocations[Math.floor(Math.random() * bangaloreLocations.length)];
            
            // Retrieve booking details from localStorage
            // Note: lockerLocation is now randomly generated on this page, not from localStorage
            const rentedItems = JSON.parse(localStorage.getItem('selectedDevices'));
            const totalAmount = localStorage.getItem('totalAmount'); // This is already in INR

            // Populate the booking details on the confirmation page
            document.getElementById('locker-location').textContent = randomLockerLocation;
            
            if (rentedItems && rentedItems.length > 0) {
                document.getElementById('device-list').textContent = rentedItems.join(', ');
            } else {
                document.getElementById('device-list').textContent = 'No devices selected.';
            }
            
            document.getElementById('total-payment').textContent = totalAmount || '0.00';

            // Generate the QR Code for the booking
            const qrCodeText = `Locker Location: ${randomLockerLocation}\nDevices: ${rentedItems ? rentedItems.join(', ') : 'None'}\nTotal Payment: â‚¹${totalAmount || '0.00'}`;
            
            const qrCode = new QRCode(document.getElementById("qr-code"), {
                text: qrCodeText,
                width: 128,
                height: 128,
                colorDark : "#1A1A2E", // Match dark theme
                colorLight : "#ffffff",
                correctLevel : QRCode.CorrectLevel.H
            });
        };
    </script>
</body>
</html>
